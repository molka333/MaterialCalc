# Веб-приложение для подсчета материалов (Калькулятор смет)
**Цель:** Создать веб-приложение для автоматизации расчета количества и стоимости материалов в проектах (например, сантехнических, строительных) с помощью переиспользуемых шаблонов и иерархической структуры материалов.
## Шапка сайт 
### Разделы
Главная | Материалы | обновить характеристики по ссылке 
## Главная 
### Боковая панель (Левое меню проектов)
- Сворачивание/разворачивание.
- Список проектов: Отображается в виде дерева(как папки)
- **Действия с проектами**:
    - Создание нового проекта (ввод названия).
    - Выбор активного проекта.
    - Удаление проекта (с подтверждением).
    - Дублирование проекта.
- **Управление шаблонами (CRUD):**
    - Шаблон — это сохраненный набор материалов со своей структурой (дочерние элементы, дополнения), который не является проектом.
    - Создание шаблона: аналогично созданию проекта, но с пометкой «шаблон». Возможность сохранить текущий проект как шаблон.
    - Добавление шаблона в активный проект: все материалы из шаблона добавляются в таблицу проекта как независимая группа.
    - Редактирование/удаление шаблонов.
### Основная рабочая область (Мэйн)
таблица
общий раздел(все материалы что есть в проеке)
**Иерархическое отображение:** Материалы группируются по шаблонам. Каждый шаблон — своя секция (возможно, с возможностью свернуть/развернуть).
- **Структура строки материала (уточнение):**
    - **Материал:** Модальное окно в виде списка материалов с возможность поиска, фильтра, сортировок.
    - **Кол-во:** Редактируемое поле. Изменение пересчитывает все зависимые стоимости.
    - **Сценарий/Тип подключения:** Выпадающий список, влияющий на состав дочерних элементов (опционально).
    - **Дочерние материалы:** Отображаются вложенным списком под родительским материалом. Рассчитываются по формуле `(базовый набор дочерних) * (количество родителя)`.
    - **Автоматические дополнения:** Рассчитываются по заданным правилам (например, `Кол-во хабов = ceil(Кол-во_радиаторов * 2)`). Логику правил нужно описать отдельно.
    - **Стоимости:** Каждая единица материала должна иметь свою базовую цену (берется из каталога). Стоимости столбцов рассчитываются:
        - `Стоимость = Цена материала * Кол-во`
        - `Стоимость дочерних = Сумма(Цена_дочернего_i * Кол-во_дочернего_i)`
        - Стоимость дополнений = цена материала * Кол-во
        - `Общая стоимость строки = Стоимость + Стоимость дочерних + Стоимость дополнений
- **Итоговая строка:** Внизу таблицы — общая сумма по проекту.
- **Функции таблицы:**
    - **Добавить материал:** Из каталога или как произвольную позицию.
    - **Действия со строкой/группой:** Редактировать, удалить, копировать, переместить.
    - **Экспорт:** Кнопка «Экспорт в Excel». Варианты выгрузки:
        1. `Полная` (со всеми столбцами и иерархией).
        2. `Упрощенная` (Только название материала, общее количество, итоговая стоимость позиции).
        3. `Спецификация` (Список всех уникальных материалов из проекта с суммарным количеством, без группировки по шаблонам).

| материал | количество | сценарий           | дочерние                                                                    | автоматические дополнения   | стоимость     | стоимость дочерних                   | стоимость дополнений | общая стоимость |
| -------- | ---------- | ------------------ | --------------------------------------------------------------------------- | --------------------------- | ------------- | ------------------------------------ | -------------------- | --------------- |
| Радиатор | 2 шт       | Нижнее подключение | (Кран - 1 шт, Труба - 2м) * 2                                               | Хаб 2 (количество(2шт) * 1) | 4500*2=9000 ₽ | (600 + 100р/м*2) = 800 ₽ * 2 = 1600р | 2000 р               | 12600 ₽         |
|          |            |                    | выбран радиатор у него дочерний кран у крана дочерний труба добавляются оба |                             |               |                                      |                      |                 |
| *итог*   |            |                    |                                                                             |                             |               |                                      |                      | 12 600р         |

## Материалы 
Централизованное хранилище всех материалов с характеристиками и связями.
**Вкладки:**
- **Вкладки:**
    1. **Все материалы:** Таблица/карточки с названием, артикулом, базовой ценой, единицами измерения, категорией, список сценариев с их дочерними элементами, список дополнительных материалов с их формулами. CRUD-операции. Фильтры по категории, названию, наличию дочерних элементов.
    2. **Добавить материал:** Форма создания нового материала.
        - Обязательные поля: Название, Категория, Ед. измерения(Сылка с автоматическим парсом всех дыннх).
        - Важные поля: Базовая цена, Артикул(автоматически).
        - **Блок «Связанные материалы»:** Здесь определяются **дочерние материалы** и правила для **автоматических дополнений**.
	        - **Автоматическое дополнение:** Выбор характеристики текущего продукта -> выбор продукта с изменяющимся параметром -> выбор изменяющегося параметра -> выбор отношения того как связанны характеристики текущего и выбранного материала <br>**Пример:** радиатора -> количество -> хаб -> количество разъемов -> 1:2(на один радиатор:2 разъема)
    3. **Требуют внимания:** Список материалов, у которых:
        - Изменилась или удалилась связь с дочерним материалом (дочерний был удален из каталога).
        - не рабочая сылка.
    4. **История изменений:** Список материалов, обновленных через парсинг по ссылке. Отображение в формате: `[Дата] Поле "Цена": 4500 ₽ → 4700 ₽`.
## Обновление данных
- **Кнопка «Запустить обновление»:** Система проходит по всем материалам в каталоге, у которых указана ссылка на сайт поставщика, и пытается получить актуальные данные (прежде всего цену, наличие).
- **Отчет после обновления:**
    - Статус: Успешно / Не удалось (с ошибкой, например, изменилась структура страницы).
    - Список измененных материалов с детализацией (как во вкладке «История изменений»).
    - **Важно:** Обновление в каталоге **не должно** автоматически менять данные в существующих проектах. Это предотвратит «плывущую» смету. В проекте можно добавить уведомление: «Цена материала в каталоге изменилась. Обновить в проекте?».
